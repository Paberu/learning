К большому моему сожалению, мне не придумать более оптимального, чем поиск подматрицы в матрице.
Единственный вариант, который мне видится соблазнительным, это создание такой матрицы:
```
0 0 1 0 0
0 0 1 0 0 
1 1 1 1 1
0 0 1 0 0
0 0 1 0 0
```
И далее создание сложного алгоритма по поиску частичных пересечений, чтобы находились как отдельный 3, 4 или 5 на одной прямой, так и угловые совпадения, и их комбинации.
Является ли такой подход оптимальным? Точно нет. Его сложно реализовать и ещё сложнее объяснить тому, кто его будет поддерживать. Но потенциальная скорость обработки, мне кажется, будет очень высокой.